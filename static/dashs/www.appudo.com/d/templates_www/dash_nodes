{"foot":"<style name=\"stl_dash_nodes\">\n    #add_form {\n        width:100%;\n        text-align:center;\n    }\n    .tlist td:nth-child(1), .tlist th:nth-child(1) {\n        width:45%;\n    }\n    .tlist td:nth-child(2), .tlist th:nth-child(2) {\n        width:45%;\n    }\n    .tlist td:nth-child(3), .tlist th:nth-child(3) {\n        width:10%;\n    }\n</style>","body": {"minit":"<script>minit('dash_nodes',['content'], {srefs:['content'],sid:'stl_dash_nodes'});</script>","misc":"<script>moduleCtx['dash_nodes']=function(){\n    return {\n        register:{\"foot\":\"<style name=\\\"stl_node_register\\\">\\n    .box1 { \\n        margin-top:32px;\\n    }\\n</style>\",\"body\": {\"minit\":\"<script>minit('node_register',['add_form'], {srefs:['add_form'],sid:'stl_node_register'});<\\/script>\",\"misc\":\"<script>moduleCtx['node_register']=function(){\\n    return {\\n        nosel:true,\\n        rstFrm : function(frm) {\\n            frm[0].reset();\\n        },\\n        validateFrm : function(frm) {\\n            var _this = this;\\n            var data = frm[0]._sdata || frm.serializeJSON();\\n            _this.doSubmit.call(_this, data);\\n        },\\n        finSubmit : function() {\\n\\t\\t    this.rstFrm($('#regNFrm'));\\n        },\\n        doSubmit : function(fdt) {\\n            var _this = this;\\n            var info = this.i18n.info;\\n            var ty = 0;\\n            \\n            if(!isMaster())\\n            {\\n                fdt.ex = 1;\\n            }\\n            \\n            ty |= fdt.ex ? 1 << 0 : 0;  \\n            ty |= fdt.ma ? 1 << 1 : 0;  \\n            ty |= fdt.dn ? 1 << 2 : 0;  \\n            ty |= fdt.us ? 1 << 3 : 0;  \\n            ty |= fdt.pk ? 1 << 4 : 0;  \\n            ty |= fdt.st ? 1 << 5 : 0;  \\n            ty |= fdt.sc ? 1 << 6 : 0;  \\n            fdt.ty = ty;\\n            \\n            var d = {cmd:8, data:JSON.stringify({ds:fdt.ds, ty:ty})}\\n            var ds = fdt.ds;\\n            \\n            delete fdt.ds;\\n            delete fdt.ma;\\n            delete fdt.dn;\\n            delete fdt.us;\\n            delete fdt.pk;\\n            delete fdt.st;\\n            delete fdt.sc;\\n            delete fdt.ex;\\n            \\n            postCreds(userBase('/admin/'), {data:JSON.stringify(d), fwd:JSON.stringify(fdt)}, function(data) {\\n                if(data.r != 0) {\\n                    modalError(info.afail)\\n                } else {\\n                    _this.finSubmit();\\n                    if(_this.onAdd) {\\n                        fdt.ds = ds;\\n                        _this.onAdd(fdt, data);\\n                    }\\n                }\\n            });\\n        },\\n        hide : function() {\\n            this.onUnload(true);\\n        },\\n        run : function() {\\n            var _this = this; \\n            var frm = $('#regNFrm');\\n            \\n            $('#abrt').click(function(){_this.hide.call(_this);});\\n               \\n            handleError(frm, function() {\\n                _this.validateFrm.call(_this, frm);\\n            }, '');   \\n            \\n            frm.submit(function(e) {\\n                e.preventDefault();\\n            });\\n        }\\n    }\\n}();<\\/script>\",\"add_form\":\"<div><div class=\\\"htop\\\"><h1>{{info.add}}<\\/h1><\\/div><div class=\\\"frmBox\\\"><form id=\\\"regNFrm\\\" class=\\\"frm min\\\"><div class=\\\"box1\\\" style=\\\"float:left;\\\"><label for=\\\"ipv4\\\">{{frm.ipv4}}*:<\\/label><input type=\\\"text\\\" id=\\\"ipv4\\\" name=\\\"ipv4\\\" pattern=\\\"((^|\\\\.)((25[0-5])|(2[0-4]\\\\d)|(1\\\\d\\\\d)|([1-9]?\\\\d))){4}$\\\" required=\\\"\\\"><label for=\\\"ipv6\\\">{{frm.ipv6}}:<\\/label><input type=\\\"text\\\" id=\\\"ipv6\\\" name=\\\"ipv6\\\" pattern=\\\"((^|:)([0-9a-fA-F]{0,4})){1,8}$\\\"><label class=\\\"master\\\">Node Options:<\\/label><div style=\\\"clear:both;\\\"><\\/div><div class=\\\"noclear master\\\"><label for=\\\"ma\\\">{{frm.ma}}<\\/label><input type=\\\"checkbox\\\" id=\\\"ma\\\" name=\\\"ma\\\" value=\\\"ma\\\"><label for=\\\"dn\\\">{{frm.dn}}<\\/label><input type=\\\"checkbox\\\" id=\\\"dn\\\" name=\\\"dn\\\" value=\\\"dn\\\"><label for=\\\"us\\\">{{frm.us}}<\\/label><input type=\\\"checkbox\\\" id=\\\"us\\\" name=\\\"us\\\" value=\\\"us\\\"><label for=\\\"pk\\\">{{frm.pk}}<\\/label><input type=\\\"checkbox\\\" id=\\\"pk\\\" name=\\\"pk\\\" value=\\\"pk\\\"><div style=\\\"clear:both;\\\"><\\/div><label for=\\\"st\\\">{{frm.st}}<\\/label><input type=\\\"checkbox\\\" id=\\\"st\\\" name=\\\"st\\\" value=\\\"st\\\"><label for=\\\"sn\\\">{{frm.sc}}<\\/label><input type=\\\"checkbox\\\" id=\\\"sc\\\" name=\\\"sc\\\" value=\\\"sc\\\"><label for=\\\"ex\\\">{{frm.ex}}<\\/label><input type=\\\"checkbox\\\" id=\\\"ex\\\" name=\\\"ex\\\" value=\\\"ex\\\"><\\/div><\\/div><div class=\\\"box2\\\" style=\\\"float:left;\\\"><label for=\\\"ps\\\">{{frm.ps}}*:<\\/label><div style=\\\"clear:both;\\\"><\\/div><div style=\\\"margin:0 10px 0 10px;\\\"><textarea id=\\\"ps\\\" name=\\\"ps\\\" required=\\\"\\\"><\\/textarea><\\/div><label for=\\\"ds\\\">{{frm.ds}}:<\\/label><div style=\\\"clear:both;\\\"><\\/div><div style=\\\"margin:0 10px 0 10px;\\\"><textarea id=\\\"ds\\\" name=\\\"ds\\\"><\\/textarea><\\/div><div><input type=\\\"submit\\\" style=\\\"float:right;margin-top:10px;margin-right:10px\\\" value=\\\"{{frm.sub}}\\\"><input type=\\\"button\\\" id=\\\"abrt\\\" style=\\\"float:right;margin-top:10px;margin-right:10px\\\" value=\\\"{{frm.cls}}\\\"><\\/div><div style=\\\"clear:both;\\\"><\\/div><\\/div><\\/form><\\/div><\\/div>\"}},\n        ipp:10,\n        max:0,\n        page:1,\n        order:null,\n        filter1:null,\n        filter2:null,\n        filter3:null,\n        selected:null,\n        hasAdd:false,\n        unloadAdd:null,\n        unload:function() {\n            if(this.hasAdd && this.unloadAdd)\n               this.unloadAdd(); \n        },\n        renderPages : function() {\n            var i18n = this.i18n.menu;\n            var itemsPerPage = this.ipp;\n            var thePage = this.page;\n            var offset = (thePage-1)*itemsPerPage\n            var numItems = this.max + offset\n            var numPages = Math.floor(numItems / itemsPerPage) + (numItems % itemsPerPage != 0 ? 1 : 0)\n            var data = '<span>' + i18n.pg + ' (' + numPages + '):</span>';\n            var lnk = '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'setPage\\',[\\'';\n            \n            data += '<div class=\"pmi\">';\n            if(thePage != 1) {\n                data += lnk + '1\\'])\">' + i18n.frt + '</a>';\n                data += lnk + (thePage - 1) + '\\'])\">' + i18n.prv + '</a>';\n            } else {\n                data += '<span class=\"dbl\">' + i18n.frt + '</span>';\n                data += '<span class=\"dbl\">' + i18n.prv + '</span>';\n            }\n            data += '</div>';\n            \n            var begin = thePage - 2\n            \n            if(begin <= 0) {\n                begin = 1\n            }\n            \n            let upper = begin + 5\n            \n            data += '<div class=\"pmi pmim\">';\n            for(var i = begin; i < upper; i++) {\n                if(i > numPages) {\n                    break\n                }\n                \n                if(i != thePage) {\n                    data += lnk + i + '\\'])\">' + i + '</a>';\n                } else {\n                    data += '<span class=\"cur\">' + thePage + '</span>';\n                }\n            }\n            data += '</div>';\n            \n            data += '<div class=\"pmi\">';\n            if(thePage != numPages) {\n                data += lnk + (thePage + 1) + '\\'])\">' + i18n.nxt + '</a>';\n                data += lnk + numPages + '\\'])\">' + i18n.lst + '</a>';\n            } else {\n                data += '<span class=\"dbl\">' + i18n.nxt + '</span>';\n                data += '<span class=\"dbl\">' + i18n.lst + '</span>';\n            }\n            data += '</div>';\n            \n            $('.pmenu').html(data);\n        },\n        renderIPP : function() {\n            var _this = this;\n            var i18n = this.i18n.menu;\n            var info = this.i18n.info;\n            var num = [1, 10, 20, 30, 50, 100, 200];\n            $('#tmenu').text('');\n            var data = '<tr class=\"filter frm btnBox tfm\"><td colspan=\"3\" class=\"smenu\">';\n                data += '<span>' + i18n.ipp + ':</span>'\n            for(var i = 0; i < num.length; i++) {\n                var n = num[i];\n                data += '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'setIPP\\',[\\'' + n + '\\']);\">' + n + '</a>';\n            }\n            data += '</td></tr>' +\n                       '<tr class=\"filter frm btnBox\"><td colspan=\"3\">' + \n                       '<button type=\"button\">' + info.cl + '</button></td></tr>';\n            var e = $('#tmenu').append(data);\n            var btns = e.find('button');\n            $(btns[0]).click(function(e){e.preventDefault();_this.renderMenu.call(_this);});\n        },\n        preFilterStatus : function(v) {\n            var i18n = this.i18n.info;\n            var r = undefined;\n            if(i18n.pnd.indexOf(v) != -1)\n                r = true;\n            if(i18n.rdy.indexOf(v) != -1) {\n                if(r !== undefined)\n                    return undefined;\n                r = false; \n            }\n            return r;\n        },\n        buildOrder : function(idx, o) {\n            if(!o || (o >> 1) - 1 != idx)\n                return '<a href=\"#\"><span class=\"fbtn\">&#9650;&#9660;</span></a>';\n            \n            return '<a href=\"#\"><span class=\"fbtn\">' + ((o & 1) == 0 ? '&#9650;' : '&#9660;') + '</span></a>';\n        },\n        renderOrder : function(obj) {\n            var _this = this;\n            var hrefs = $('#tmenu').find('a');\n            for(var i = 0; i < hrefs.length; i++) {\n                $(hrefs[i]).replaceWith(this.buildOrder(i, obj.o));\n            }\n            hrefs = $('#tmenu').find('a');\n            var v = [];\n            for(var i = 0; i < hrefs.length; i++) {\n                (function(i, o) {\n                    var n = (o >> 1) - 1 != i;\n                    var ov = (i + 1) << 1;\n                    if(!n) {\n                        if((o & 1))\n                            ov = 0;\n                        else\n                            ov |= 1;\n                    }\n                    $(hrefs[i]).click(function(e){\n                        e.preventDefault();\n                        obj.o = ov;\n                        _this.renderOrder(obj);\n                    });\n                })(i, obj.o);\n            }\n        },\n        renderFilter : function() {\n            var _this = this;\n            var i18n = this.i18n.menu;\n            var info = this.i18n.info;\n            $('#tmenu').text('');\n            var data = '<tr class=\"filter frm btnBox tfm\"><td><input type=\"text\" placeholder=\"' + info.nm  + '...\"><a/></td>' + \n                       '<td><input type=\"text\" placeholder=\"' + info.dsc  + '...\"><a/></td>' + \n                       '<td><input type=\"text\" placeholder=\"' + info.ste  + '...\"><a/></td></tr>' +\n                       '<tr class=\"filter frm btnBox\"><td colspan=\"3\">' +\n                       '<button type=\"submit\">' + i18n.ftr + '</button>' + \n                       '<button type=\"button\">' + i18n.rst + '</button>' + \n                       '<button type=\"button\">' + info.cl + '</button></td></tr>';\n            var items = $('#tmenu').append(data);\n            var fobj = {o: this.order}\n            \n            this.renderOrder(fobj);\n            \n            var inputs = items.find('input');\n            var btns = items.find('button');\n            var hrefs = items.find('a');\n            \n            $(inputs[0]).val(this.filter1);\n            $(inputs[1]).val(this.filter2);\n            $(inputs[2]).val(this.filter3);\n            \n            $(btns[0]).click(function(e){e.preventDefault();_this.setFilter.call(_this, $(inputs[0]).val(), $(inputs[1]).val(), $(inputs[2]).val(), fobj.o + '')});\n            $(btns[1]).click(function(e){e.preventDefault();_this.resetFilter.call(_this);});\n            $(btns[2]).click(function(e){e.preventDefault();_this.renderMenu.call(_this);});\n        },\n        renderMenu : function() {\n            var _this = this;\n            var i18n = this.i18n.menu;\n            $('#tmenu').text('');\n            var data = '<tr ><td colspan=\"3\"><a href=\"#\">' + i18n.add + '</a> | <a href=\"#\">' + i18n.fts + '</a> | <a href=\"#\">' + i18n.ipp + ' (' + this.ipp + ')</a></td></tr>';\n            var items = $('#tmenu').append(data);\n            var btns = items.find('a');\n            $(btns[0]).click(function(e){e.preventDefault();_this.showAdd.call(_this);});\n            $(btns[1]).click(function(e){e.preventDefault();_this.renderFilter.call(_this);});\n            $(btns[2]).click(function(e){e.preventDefault();_this.renderIPP.call(_this);});\n        }, \n        renderEdit : function(id, name) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            \n            var item = $('#_item_' + id);\n            var idata = this.fromElem(item);\n            var data = '<tr class=\"sel0 titem\"><td>' + idata.n + '</td><td><textarea id=\"edtxt\" class=\"edtxt\">' + idata.d + '</textarea></td><td>' + (idata.p == 1 ? i18n.pnd : i18n.rdy) + '</td></tr><tr><tr><td colspan=\"3\"><div style=\"margin-bottom:10px;\">' +\n                        i18n.dsav + \n                       '</div><div class=\"frm btnBox\"><button id=\"aabrt\" type=\"button\"\">' + i18n.cl + '</button><button id=\"sav\" type=\"submit\">' + i18n.sav + '</button></div></td></tr>';\n            var r = this._selItem(id, data, true, item);\n            r.a.addClass('hide');\n            r.a.removeClass('sel0');\n            $(r.b[0]).removeClass('sel1');\n            r.b._remove = function() {\n                r.a.removeClass('hide');\n            };\n            \n            $('#aabrt').click(function(){_this.selItem.call(_this, id, true);});\n            $('#sav').click(function(){idata.d = $('#edtxt').val(); _this.doSave.call(_this, idata, r.a);});\n        \n        },\n        renderRem : function(id) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            var item = this.fromId(id);\n            var data = '<tr><td colspan=\"3\"><div style=\"margin-bottom:10px;\">' +\n                        i18n.rrem + \n                       '</div><div class=\"frm btnBox\"><button id=\"aabrt\" type=\"button\" style=\"margin-right:10px;\">' + i18n.cl + '</button><button id=\"rem\" type=\"button\">' + i18n.rm + '</button></div></td></tr>';\n            this._selItem(id, data, true);\n            $('#aabrt').click(function(){_this.selItem.call(_this, id, true);});\n            $('#rem').click(function(){_this.doRemove.call(_this, id);});\n        },\n        renderTable : function(data) {\n            $('#result').text('');\n            for(var i = 0; i < data.length; i++) {\n                if(data[i].e == undefined) {\n                    this.renderRow(data[i])\n                }\n            }\n            this.renderPages();\n        },\n        renderTableHdr : function() {\n            var i18n = this.i18n.info;\n            $('#thdr').html('<tr class=\"thdr\"><th>' + i18n.nm  +\n                            '</th><th>' +  i18n.dsc  +\n                            '</th><th>' +  i18n.ste + '</th></tr>');\n        },\n        renderRow : function(item, front) {\n            if(front)\n                $('#result').prepend(this.buildRow(item));\n            else\n                $('#result').append(this.buildRow(item));\n        },\n        buildRow : function(item) {\n            var i18n = this.i18n.info;\n            var data = '<tr id=\"_item_' + item.id + '\" class=\"titem\" onclick=\"javascript:mCall(' + '\\'' + \n            this._module + '\\'' + ',\\'selItem\\',[\\'' + item.id + '\\']);\"><td>' + \n            item.n + '</td><td>' + item.d + '</td><td d=\"' + item.p + '\">' + (item.p == 1 ? i18n.pnd : i18n.rdy) + '</td></tr>';\n            return data;\n            \n        },\n        setPage: function(p, passiv) {\n            var np = parseInt(p);\n            var o = this.getOpt({p:np-1});\n            this.doList(o);\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.p;\n                if(np != 1) params.p = np;\n                putSearchMenu(params);\n            }\n        },\n        setIPP : function(ipp, passiv) {\n            var _this = this;\n            var n = parseInt(ipp);\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.p;\n                delete params.i;\n                if(n != 10) params.i = n;\n                putSearchMenu(params);\n            }\n            this.doList(this.getOpt({i:n,p:0}), function() {\n                _this.renderMenu();\n            });\n        },\n        setFilter : function(f1, f2, f3, o, passiv) {\n            var _this = this;\n            var on = parseInt(o) || 0;\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.f1;\n                delete params.f2;\n                delete params.f3;\n                delete params.o;\n                delete params.p;\n                if(f1) params.f1 = f1;\n                if(f2) params.f2 = f2;\n                if(f3) params.f3 = f3;\n                if(on != 0) params.o = on;\n                putSearchMenu(params);\n            }\n            this.doList(this.getOpt({f1:f1,f2:f2,f3:f3,o:on,p:0}), function() {\n            });\n        },\n        resetFilter : function(passiv) {\n            var _this = this;\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.f1;\n                delete params.f2;\n                delete params.f3;\n                delete params.o;\n                putSearchMenu(params);\n            }\n            this.doList(this.getOpt({f1:\"\", f2:\"\", f3:\"\", o:0, p:0}), function() {\n                _this.renderFilter();\n            });\n        },\n        gotoAddDash : function(id) {\n            var item = this.fromId(id);\n            spf.navigate('/dashs?nid=' + id + '&n=' + item.n);\n        },\n        selItem : function(id, keep, passiv) {\n            var e = this.fromId(id);\n            if(e)\n                this.doSelItem(e, keep, passiv);\n        },\n        doSelItem : function(item, keep, passiv) {\n            var i18n = this.i18n.info;\n            var id = item.id;\n            var data = '<tr><td colspan=\"3\">' +\n              '<a target=\"_blank\" href=\"' + userBase('', item.n) + '\">' + i18n.lnk + '</a>' +\n              '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'copyName\\',[\\'' + id + '\\']);\">' + i18n.cpy + '</a>' +\n              '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'gotoAddDash\\',[\\'' + id + '\\']);\">' + i18n.ad + '</a>' +\n              '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'renderEdit\\',[\\'' + id + '\\']);\">' + i18n.ed + '</a>' +\n              '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'renderRem\\',[\\'' + id + '\\']);\">' + i18n.rm + '</a>' +\n              '</td></tr>';\n            this._selItem(id, data, keep);\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.s;\n                if(this.selected)\n                    params.s = id;\n                putSearchMenu(params);\n            }\n        },\n        _selItem : function(id, data, keep, _item) {\n            var item = _item || $('#_item_' + id);\n            var selected = this.selected;\n            if(selected) {\n                selected.a.removeClass('sel0');\n                if(selected.b._remove)\n                    selected.b._remove();\n                selected.b.remove();\n                this.selected = null;\n                if(selected.a[0].id === item[0].id && !keep) \n                    return;\n            } \n            \n            var after = $(data).insertAfter(item);\n            item.addClass('sel0');\n            after.addClass('sel1');\n        \t\n            this.selected = {a:item,b:after};\n            return this.selected;\n        },\n        getOpt : function(o) {\n            var r = {};\n            if(this.page != 1)\n                r.p = this.page - 1;\n            r.i = this.ipp || 10;\n            r.f1 = this.filter1 || \"\";\n            r.f2 = this.filter2 || \"\";\n            r.f3 = this.filter3 || \"\";\n            r.o = this.order || 0;\n            r = $.extend(r, o);\n            if(r.i  == 10) delete r.i;\n            if(r.p  == 0)  delete r.p;\n            if(r.f1 == \"\") delete r.f1;\n            if(r.f2 == \"\") delete r.f2;\n            if(r.f3 == \"\") delete r.f3;\n            if(r.o  == 0) delete r.o;\n            if(r.i === undefined && r.p === undefined && r.f1 === undefined && r.f2 === undefined && r.f3 === undefined && r.o === undefined)\n                return null;\n            return r;\n        },\n        copyName : function(id) {\n            var item = $('#_item_' + id)[0].firstChild;\n            var temp = $(\"<input>\");\n            $(\"body\").append(temp);\n            temp.val($(item).text()).select();\n            document.execCommand(\"copy\");\n            temp.remove();\n        },\n        fromId : function(id) { \n            var e = $('#_item_' + id);\n            if(e.length != 0)\n                return this.fromElem(e);\n            return null;\n        },\n        fromElem : function(e) {\n            var r = {};\n            var c = e.children();\n            r.id = parseInt(e.attr('id').substr(6));\n            r.n = $(c[0]).text();\n            r.d = $(c[1]).text();\n            r.p = parseInt($(c[2]).attr('d'));\n            return r;\n        },\n        replaceNode : function(item, elem) {\n            elem.replaceWith(this.buildRow(item));\n            this.doSelItem(item, true);\n        },\n        doList : function(o, after, p) {\n            var i18n = this.i18n.info;\n            var _this = this;\n            var params = p || parseSearch();\n            this.renderTableHdr();\n            this.page = 1;\n            this.ipp = 10;\n            this.filter1 = undefined;\n            this.filter2 = undefined;\n            this.filter3 = undefined;\n            this.order = undefined;\n            this.selected = undefined;\n            var d = {cmd:7};\n            if(o)\n            {\n                if(o.i)  this.ipp = o.i;\n                if(o.p)  this.page = o.p + 1;\n                if(o.f1) this.filter1 = o.f1;\n                if(o.f2) this.filter2 = o.f2;\n                if(o.f3) this.filter3 = o.f3;\n                if(o.o)  this.order = o.o;\n                if(o.f3)\n                    o.f3 = this.preFilterStatus(o.f3);\n                if(o.p)\n                    o.p = o.p * this.ipp;\n                d.data = JSON.stringify(o);\n            }\n            postCreds(userBase('/admin/'), {data:JSON.stringify(d)}, function(data) {\n                if(data.r == 0) {\n                    _this.max = typeof data.m === 'number' ? data.m : 0;\n                    _this.renderTable(data.d);\n                    if(params.s) {\n                        _this.selItem(params.s, false, true);\n                    }\n                } else {\n                    modalError(i18n.lfail);\n                }\n                \n                if(after)\n                    after();\n            });\n        },\n        showAdd : function() {\n            var i18n = this.i18n.info;\n            var _this = this;\n            if(!this.hasAdd) {\n                this.hasAdd = true;\n                loadContent('node_register', this.register, 'onUnload', function(unload) {\n                    _this.unloadAdd = unload;\n                    $('html, body').animate({\n                        scrollTop: $(\"#add_form\").offset().top - hdrHeight - 10\n                    }, 200);\n                    moduleCtx['node_register'].onAdd = function(d, r) {\n                        _this.renderRow({id:r.id,n:r.n,p:1,d:d.ds}, true);\n                        _this.selItem(r.id);\n                        modalInfo(i18n.aok);\n                    }\n                }, function() {\n                    _this.hasAdd = false; \n                    \n                    $('html, body').animate({\n                        scrollTop: 0\n                    }, 200);\n                }); \n            }\n        },\n        doSave : function(item, elem) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            postCreds(userBase('/admin/'), {data:'{\"cmd\":17, \"data\":' + JSON.stringify(JSON.stringify({id:item.id,d:item.d})) + '}'}, function(data) {\n                if(data.r == 0) {\n                    _this.replaceNode(item, elem);\n                    _this.selItem(item.id, true, true);\n                } else {\n                    modalError(i18n.sfail);\n                }\n            });\n            \n        },\n        doRemove : function(id) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            postCreds(userBase('/admin/'), {data:'{\"cmd\":9, \"data\":' + JSON.stringify(id) + '}'}, function(data) {\n                if(data.r == 0) {\n                    _this.selItem(id, false, false);\n                    $('#_item_' + id).remove();\n                } else {\n                    modalError(i18n.rfail);\n                }\n            });\n        },\n        run : function() {\n            var _this = this;\n            var params = parseSearch();\n            \n            var o = {};\n            if(params.p)  o.p = parseInt(params.p) - 1;\n            if(params.i)  o.i = parseInt(params.i);\n            if(params.f1) o.f1 = params.f1;\n            if(params.f2) o.f2 = params.f2;\n            if(params.f3) o.f3 = params.f3;\n            if(params.o)  o.o = parseInt(params.o);\n            \n            this.doList(o, function() {\n                if(_this.filter1 || _this.filter2 || _this.filter3 || _this.order != undefined)\n                    _this.renderFilter();\n                else\n                    _this.renderMenu();\n            }, params);\n            \n        }\n    }\n}();</script>","content":"<div class=\"linner\"><div id=\"add_form\"></div><form onsubmit=\"return false;\"><table class=\"tlist thead\" style=\"margin-top:20px;\"><thead class=\"full\"><tr><th><h1>{{info.head}}</h1></th><th></th><th></th></tr></thead><tbody id=\"tmenu\"></tbody></table></form><div class=\"pmenu\"></div><form onsubmit=\"return false;\"><table class=\"tlist\"><thead id=\"thdr\"></thead><tbody id=\"result\"></tbody></table></form><div class=\"pmenu\"></div><div style=\"clear:both;\"></div></div>"}}