{"foot":"<style name=\"stl_dash_domains\">\n    #add_form {\n        width:100%;\n        text-align:center;\n    }\n    .tlist td:nth-child(1), .tlist th:nth-child(1) {\n        width:30%;\n    }\n    .tlist td:nth-child(2), .tlist th:nth-child(2) {\n        width:30%;\n    }\n    .tlist td:nth-child(3), .tlist th:nth-child(3) {\n        width:25%;\n    }\n    .tlist td:nth-child(4), .tlist th:nth-child(4) {\n        width:15%;\n    }\n</style>","body": {"minit":"<script>minit('dash_domains',['content'], {srefs:['content'],sid:'stl_dash_domains'});</script>","misc":"<script>moduleCtx['dash_domains']=function(){\n    return {\n        domains:{\"foot\":\"<style name=\\\"stl_domain_add\\\">\\n    .box1 {\\n        padding-bottom:0;\\n    }\\n</style>\",\"body\": {\"minit\":\"<script>minit('domain_add',['add_form'], {srefs:['add_form'],sid:'stl_domain_add'});<\\/script>\",\"misc\":\"<script>moduleCtx['domain_add']=function(){\\n    return {\\n        nosel:true,\\n        rstFrm : function(frm) {\\n            frm[0].reset();\\n        },\\n        validateFrm : function(frm) {\\n            var _this = this;\\n            var data = frm.serializeJSON();\\n            _this.doSubmit.call(_this, data);\\n        },\\t\\n        finSubmit : function() {\\n\\t\\t    this.rstFrm($('#DmnAddFrm'));\\n        },\\n        doRegister : function(did, an, dn, after) {\\n            getNodeByDashID(did, function(node) {\\n                 postCredsCross({id:node.id}, userBase('/server/', node.name), {data:'{\\\"cmd\\\":9,\\\"data\\\":' + JSON.stringify(JSON.stringify({an:an,dn:dn,sn:''})) + '}'}, function(data) {\\n                    if(data.r == 0 || data.r == 270532633) { /* ok or not exist */\\n                        after();\\n                    } else {\\n                        modalError(info.afail);\\n                    }\\n                 });\\n            });\\n        },\\n        doSubmit : function(fdt) {\\n            var _this = this;\\n            var info = this.i18n.info;\\n            fdt.td = parseInt(fdt.td);\\n            postCreds(userBase('/admin/'), {data:JSON.stringify({cmd:20,data:JSON.stringify(fdt)})}, function(data) {\\n                if(data.r != 0) {\\n                    modalError(info.afail);\\n                } else {\\n                    _this.doRegister(fdt.td, data.dn, fdt.dn, function() {\\n                        _this.finSubmit();\\n                        if(_this.onAdd) {\\n                            _this.onAdd(fdt, data);\\n                        }\\n                    });\\n                }\\n            });\\n            \\n        },\\n        hide : function() {\\n            this.onUnload(true);\\n        },\\n        run : function() {\\n            var _this = this; \\n            var frm = $('#DmnAddFrm');\\n            \\n            $('#abrt').click(function(){_this.hide.call(_this);});\\n            \\n            handleError(frm, function() {\\n                _this.validateFrm.call(_this, frm);\\n            }, '');   \\n            \\n            frm.submit(function(e) {\\n                e.preventDefault();\\n            });\\n        }\\n    }\\n}();<\\/script>\",\"add_form\":\"<div id=\\\"dashSearch\\\" class=\\\"searchContent\\\"><form onsubmit=\\\"return false;\\\" class=\\\"frm\\\"><div><input type=\\\"text\\\" placeholder=\\\"{{frm.dsrh}}\\\" id=\\\"dashInput\\\" class=\\\"search\\\"><button type=\\\"submit\\\" id=\\\"dashSBtn\\\">{{frm.srh}}<\\/button><\\/div><\\/form><a href=\\\"#about\\\">About<\\/a><a href=\\\"#base\\\">Base<\\/a><a href=\\\"#blog\\\">Blog<\\/a><a href=\\\"#contact\\\">Contact<\\/a><a href=\\\"#custom\\\">Custom<\\/a><a href=\\\"#support\\\">Support<\\/a><a href=\\\"#tools\\\">Tools<\\/a><\\/div><div class=\\\"htop\\\"><h1>{{dmn.head}}<\\/h1><\\/div><div class=\\\"frmBox\\\"><form id=\\\"DmnAddFrm\\\" class=\\\"frm min\\\"><div class=\\\"box1\\\"><div class=\\\"searchFrame\\\" style=\\\"float:right;\\\"><button id=\\\"dashBtn\\\" class=\\\"searchBtn\\\" type=\\\"button\\\">â–¼<\\/button><\\/div><label style=\\\"clear:none;\\\" for=\\\"td\\\">{{frm.td}}*:<\\/label><input type=\\\"text\\\" id=\\\"td\\\" name=\\\"td\\\" style=\\\"width:16em;\\\" pattern=\\\"[+-]?[0-9]{1,10}\\\" required=\\\"\\\"><label for=\\\"dn\\\">{{frm.dn}}*:<\\/label><input type=\\\"text\\\" id=\\\"dn\\\" name=\\\"dn\\\" pattern=\\\"^([a-zA-Z0-9]([a-zA-Z0-9\\\\-]{0,61}[a-zA-Z0-9])?\\\\.)+[a-zA-Z]{2,6}$\\\" required=\\\"\\\"><div style=\\\"clear:both;\\\"><\\/div><label for=\\\"ds\\\">{{frm.ds}}:<\\/label><div style=\\\"clear:both;\\\"><\\/div><div style=\\\"margin:0 10px 0 10px;\\\"><textarea id=\\\"ds\\\" name=\\\"ds\\\"><\\/textarea><\\/div><div><input type=\\\"submit\\\" style=\\\"float:right;margin-top:10px;margin-right:10px\\\" value=\\\"{{frm.sub}}\\\"><input type=\\\"button\\\" id=\\\"abrt\\\" style=\\\"float:right;margin-top:10px;margin-right:10px\\\" value=\\\"{{frm.cls}}\\\"><\\/div><div style=\\\"clear:both;\\\"><\\/div><\\/div><\\/form><\\/div>\"}},\n        ipp:10,\n        max:0,\n        page:1,\n        order:null,\n        filter1:null,\n        filter2:null,\n        filter3:null,\n        filter4:null,\n        selected:null,\n        hasAdd:false,\n        unloadAdd:null,\n        unload:function() {\n            if(this.hasAdd && this.unloadAdd)\n               this.unloadAdd();\n        },\n        showAdd : function(after) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            this._showAdd(function(unload) {\n                _this.unloadAdd = unload;\n                $('html, body').animate({\n                    scrollTop: $(\"#add_form\").offset().top - hdrHeight - 10\n                }, 200);\n                \n                moduleCtx['domain_add'].onAdd = function(d, r) {\n                    _this.renderRow({id:r.id,dn:r.dn,n:d.dn,did:d.td,d:d.ds,c:''}, true);\n                    _this.selItem(r.id);\n                    modalInfo(i18n.aok);\n                }\n                \n                if(after)\n                    after();\n            });\n        },\n        _showAdd : function(after) {\n            var _this = this;\n            if(!this.hasAdd) {\n                this.hasAdd = true;\n                loadContent('domain_add', this.domains, 'onUnload', after, function(active) { \n                    if(active) {\n                        var params = parseSearch();\n                        delete params.n;\n                        delete params.nid;\n                        putSearchMenu(params);\n                    }\n                    _this.hasAdd = false;\n                    $('html, body').animate({\n                        scrollTop: 0\n                    }, 200);\n                });\n            }\n        },     \n        renderPages : function() {\n            var i18n = this.i18n.menu;\n            var itemsPerPage = this.ipp;\n            var thePage = this.page;\n            var offset = (thePage-1)*itemsPerPage\n            var numItems = this.max + offset\n            var numPages = Math.floor(numItems / itemsPerPage) + (numItems % itemsPerPage != 0 ? 1 : 0)\n            var data = '<span>' + i18n.pg + ' (' + numPages + '):</span>';\n            var lnk = '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'setPage\\',[\\'';\n            \n            data += '<div class=\"pmi\">';\n            if(thePage != 1) {\n                data += lnk + '1\\'])\">' + i18n.frt + '</a>';\n                data += lnk + (thePage - 1) + '\\'])\">' + i18n.prv + '</a>';\n            } else {\n                data += '<span class=\"dbl\">' + i18n.frt + '</span>';\n                data += '<span class=\"dbl\">' + i18n.prv + '</span>';\n            }\n            data += '</div>';\n            \n            var begin = thePage - 2\n            \n            if(begin <= 0) {\n                begin = 1\n            }\n            \n            let upper = begin + 5\n            \n            data += '<div class=\"pmi pmim\">';\n            for(var i = begin; i < upper; i++) {\n                if(i > numPages) {\n                    break\n                }\n                \n                if(i != thePage) {\n                    data += lnk + i + '\\'])\">' + i + '</a>';\n                } else {\n                    data += '<span class=\"cur\">' + thePage + '</span>';\n                }\n            }\n            data += '</div>';\n            \n            data += '<div class=\"pmi\">';\n            if(thePage != numPages) {\n                data += lnk + (thePage + 1) + '\\'])\">' + i18n.nxt + '</a>';\n                data += lnk + numPages + '\\'])\">' + i18n.lst + '</a>';\n            } else {\n                data += '<span class=\"dbl\">' + i18n.nxt + '</span>';\n                data += '<span class=\"dbl\">' + i18n.lst + '</span>';\n            }\n            data += '</div>';\n            \n            $('.pmenu').html(data);\n        },\n        renderIPP : function() {\n            var _this = this;\n            var i18n = this.i18n.menu;\n            var info = this.i18n.info;\n            var num = [1, 10, 20, 30, 50, 100, 200];\n            $('#tmenu').text('');\n            var data = '<tr class=\"filter frm btnBox tfm\"><td colspan=\"4\" class=\"smenu\">';\n                data += '<span>' + i18n.ipp + ':</span>'\n            for(var i = 0; i < num.length; i++) {\n                var n = num[i];\n                data += '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'setIPP\\',[\\'' + n + '\\']);\">' + n + '</a>';\n            }\n            data += '</td></tr>' +\n                       '<tr class=\"filter frm btnBox\"><td colspan=\"4\">' + \n                       '<button type=\"button\">' + info.cl + '</button></td></tr>';\n            var e = $('#tmenu').append(data);\n            var btns = e.find('button');\n            $(btns[0]).click(function(e){e.preventDefault();_this.renderMenu.call(_this);});\n        },\n        buildOrder : function(idx, o) {\n            if(!o || (o >> 1) - 1 != idx)\n                return '<a href=\"#\"><span class=\"fbtn\">&#9650;&#9660;</span></a>';\n            \n            return '<a href=\"#\"><span class=\"fbtn\">' + ((o & 1) == 0 ? '&#9650;' : '&#9660;') + '</span></a>';\n        },\n        renderOrder : function(obj) {\n            var _this = this;\n            var hrefs = $('#tmenu').find('a');\n            for(var i = 0; i < hrefs.length; i++) {\n                $(hrefs[i]).replaceWith(this.buildOrder(i, obj.o));\n            }\n            hrefs = $('#tmenu').find('a');\n            var v = [];\n            for(var i = 0; i < hrefs.length; i++) {\n                (function(i, o) {\n                    var n = (o >> 1) - 1 != i;\n                    var ov = (i + 1) << 1;\n                    if(!n) {\n                        if((o & 1))\n                            ov = 0;\n                        else\n                            ov |= 1;\n                    }\n                    $(hrefs[i]).click(function(e){\n                        e.preventDefault();\n                        obj.o = ov;\n                        _this.renderOrder(obj);\n                    });\n                })(i, obj.o);\n            }\n        },\n        renderFilter : function() {\n            var _this = this;\n            var i18n = this.i18n.menu;\n            var info = this.i18n.info;\n            $('#tmenu').text('');\n            var data = '<tr class=\"filter frm btnBox tfm\"><td><input type=\"text\" placeholder=\"' + info.n  + '...\"><a/></td>' + \n                       '<td><input type=\"text\" placeholder=\"' + info.dsc  + '...\"><a/></td>' + \n                       '<td><input type=\"text\" placeholder=\"' + info.dn  + '...\"><a/></td>' +\n                       '<td><input type=\"text\" placeholder=\"' + info.c  + '...\"><a/></td></tr>' +\n                       '<tr class=\"filter frm btnBox\"><td colspan=\"4\">' +\n                       '<button type=\"submit\">' + i18n.ftr + '</button>' + \n                       '<button type=\"button\">' + i18n.rst + '</button>' + \n                       '<button type=\"button\">' + info.cl + '</button></td></tr>';\n            var items = $('#tmenu').append(data);\n            var fobj = {o: this.order}\n            \n            this.renderOrder(fobj);\n            \n            var inputs = items.find('input');\n            var btns = items.find('button');\n            var hrefs = items.find('a');\n            \n            $(inputs[0]).val(this.filter1);\n            $(inputs[1]).val(this.filter2);\n            $(inputs[2]).val(this.filter3);\n            $(inputs[2]).val(this.filter4);\n            \n            $(btns[0]).click(function(e){e.preventDefault();_this.setFilter.call(_this, $(inputs[0]).val(), $(inputs[1]).val(), $(inputs[2]).val(), $(inputs[3]).val(), fobj.o + '')});\n            $(btns[1]).click(function(e){e.preventDefault();_this.resetFilter.call(_this);});\n            $(btns[2]).click(function(e){e.preventDefault();_this.renderMenu.call(_this);});\n        },\n        renderMenu : function() {\n            var _this = this;\n            var i18n = this.i18n.menu;\n            $('#tmenu').text('');\n            var data = '<tr ><td colspan=\"4\"><a href=\"#\">' + i18n.add + '</a> | <a href=\"#\">' + i18n.fts + '</a> | <a href=\"#\">' + i18n.ipp + ' (' + this.ipp + ')</a></td></tr>';\n            var items = $('#tmenu').append(data);\n            var btns = items.find('a');\n            $(btns[0]).click(function(e){e.preventDefault();_this.showAdd.call(_this);});\n            $(btns[1]).click(function(e){e.preventDefault();_this.renderFilter.call(_this);});\n            $(btns[2]).click(function(e){e.preventDefault();_this.renderIPP.call(_this);});\n        }, \n        renderTable : function(data) {\n            $('#result').text('');\n            for(var i = 0; i < data.length; i++) {\n                if(data[i].e == undefined) {\n                    this.renderRow(data[i])\n                }\n            }\n            this.renderPages();\n        },\n        renderRem : function(id) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            var item = $('#_item_' + id);\n            var idata = this.fromElem(item)\n            var data = '<tr><td colspan=\"4\"><div style=\"margin-bottom:10px;\">' +\n                        i18n.rrem + \n                       '</div><div class=\"frm btnBox\"><button id=\"aabrt\" type=\"button\" style=\"margin-right:10px;\">' + i18n.cl + '</button><button id=\"arem\" type=\"button\">' + i18n.rm + '</button></div></td></tr>';\n            this._selItem(id, data, true);\n            $('#aabrt').click(function(){_this.selItem.call(_this, idata.id, true);});\n            $('#arem').click(function(){_this.doRemove.call(_this, idata);});\n        },\n        renderRemCert : function(id) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            var item = $('#_item_' + id);\n            var idata = this.fromElem(item)\n            var data = '<tr><td colspan=\"4\"><div style=\"margin-bottom:10px;\">' +\n                        i18n.crem + \n                       '</div><div class=\"frm btnBox\"><button id=\"aabrt\" type=\"button\" style=\"margin-right:10px;\">' + i18n.cl + '</button><button id=\"arem\" type=\"button\">' + i18n.dc + '</button></div></td></tr>';\n            this._selItem(id, data, true);\n            $('#aabrt').click(function(){_this.selItem.call(_this, idata.id, true);});\n            $('#arem').click(function(){_this.doRemoveCert.call(_this, idata);});\n        },\n        renderEdit : function(id) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            \n            var item = $('#_item_' + id);\n            var idata = this.fromElem(item);\n            var data = '<tr class=\"sel0 titem\"><td>' + idata.n + '</td><td><textarea id=\"edtxt\" class=\"edtxt\">' + idata.d + '</textarea></td><td>' + idata.dn + '</td><td>' + idata.c + '</td></tr><tr><tr><td colspan=\"4\"><div style=\"margin-bottom:10px;\">' +\n                        i18n.dsav + \n                       '</div><div class=\"frm btnBox\"><button id=\"aabrt\" type=\"button\" style=\"margin-right:10px;\">' + i18n.cl + '</button><button id=\"sav\" type=\"button\">' + i18n.sav + '</button></div></td></tr>';\n            var r = this._selItem(id, data, true, item);\n            r.a.addClass('hide');\n            r.a.removeClass('sel0');\n            $(r.b[0]).removeClass('sel1');\n            r.b._remove = function() {\n                r.a.removeClass('hide');\n            };\n            \n            $('#aabrt').click(function(){_this.doSelItem.call(_this, idata, true);});\n            $('#sav').click(function(){idata.d = $('#edtxt').val(); _this.doSave.call(_this, idata, r.a);});\n        \n        },\n        setPage: function(p, passiv) {\n            var np = parseInt(p);\n            var o = this.getOpt({p:np-1});\n            this.doList(o);\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.p;\n                if(np != 1) params.p = np;\n                putSearchMenu(params);\n            }\n        },\n        setIPP : function(ipp, passiv) {\n            var _this = this;\n            var n = parseInt(ipp);\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.p;\n                delete params.i;\n                if(n != 10) params.i = n;\n                putSearchMenu(params);\n            }\n            this.doList(this.getOpt({i:n,p:0}), function() {\n                _this.renderMenu();\n            });\n        },\n        setFilter : function(f1, f2, f3, f4, o, passiv) {\n            var _this = this;\n            var on = parseInt(o) || 0;\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.f1;\n                delete params.f2;\n                delete params.f3;\n                delete params.f4;\n                delete params.o;\n                delete params.p;\n                if(f1) params.f1 = f1;\n                if(f2) params.f2 = f2;\n                if(f3) params.f3 = f3;\n                if(f4) params.f4 = f4;\n                if(on != 0) params.o = on;\n                putSearchMenu(params);\n            }\n            this.doList(this.getOpt({f1:f1,f2:f2,f3:f3,f4:f4,o:on,p:0}), function() {\n            });\n        },\n        resetFilter : function(passiv) {\n            var _this = this;\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.f1;\n                delete params.f2;\n                delete params.f3;\n                delete params.f4;\n                delete params.o;\n                putSearchMenu(params);\n            }\n            this.doList(this.getOpt({f1:\"\", f2:\"\", f3:\"\", f4:\"\", o:0, p:0}), function() {\n                _this.renderFilter();\n            });\n        },\n        gotoAddCert : function(id) {\n            var item = this.fromId(id);\n            spf.navigate('/dash_certs?did=' + id + '&n=' + item.n);\n        },\n        getOpt : function(o) {\n            var r = {};\n            if(this.page != 1)\n                r.p = this.page - 1;\n            r.i = this.ipp || 10;\n            r.f1 = this.filter1 || \"\";\n            r.f2 = this.filter2 || \"\";\n            r.f3 = this.filter3 || \"\";\n            r.f4 = this.filter4 || \"\";\n            r.o = this.order || 0;\n            r = $.extend(r, o);\n            if(r.i  == 10) delete r.i;\n            if(r.p  == 0)  delete r.p;\n            if(r.f1 == \"\") delete r.f1;\n            if(r.f2 == \"\") delete r.f2;\n            if(r.f3 == \"\") delete r.f3;\n            if(r.f4 == \"\") delete r.f4;\n            if(r.o  == 0) delete r.o;\n            if(r.i === undefined && r.p === undefined && r.f1 === undefined && r.f2 === undefined && r.f3 === undefined && r.f4 === undefined && r.o === undefined)\n                return null;\n            return r;\n        },\n        copyName : function(id) {\n            var item = $('#_item_' + id)[0].firstChild;\n            var temp = $(\"<input>\");\n            $(\"body\").append(temp);\n            temp.val($(item).text()).select();\n            document.execCommand(\"copy\");\n            temp.remove();\n        },\n        doSelItem : function(item, keep, passiv) {\n            var id = item.id;\n            var name = item.nm;\n            var i18n = this.i18n.info;\n            var data = '<tr><td colspan=\"4\">' +\n                      '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'copyName\\',[\\'' + id + '\\']);\">' + i18n.cpy + '</a>' +\n                      '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'gotoAddCert\\',[\\'' + id + '\\']);\">' + i18n.ad + '</a>' +\n                      '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'renderRemCert\\',[\\'' + id + '\\']);\">' + i18n.rc + '</a>' +\n                      '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'renderEdit\\',[\\'' + id + '\\']);\">' + i18n.ed + '</a>' +\n                      '<a href=\"javascript:mCall(' + '\\'' + this._module + '\\'' + ',\\'renderRem\\',[\\'' + id + '\\']);\">' + i18n.rm + '</a>' +\n                      '</td></tr>';\n            this._selItem(id, data, keep);\n            if(!passiv) {\n                var params = parseSearch();\n                delete params.s\n                if(this.selected) \n                    params.s = id;\n                putSearchMenu(params);\n            }\n        },\n        selItem : function(id, keep, passiv) {\n            var e = this.fromId(id);\n            if(e)\n                this.doSelItem(e, keep, passiv);\n        },\n        _selItem : function(id, data, keep, _item) { \n            var item = _item || $('#_item_' + id);\n            var selected = this.selected;\n            if(selected) {\n                selected.a.removeClass('sel0');\n                if(selected.b._remove)\n                    selected.b._remove();\n                selected.b.remove();\n                this.selected = null;\n                if(selected.a[0].id === item[0].id && !keep) \n                    return;\n            } \n            \n            var after = $(data).insertAfter(item);\n            item.addClass('sel0');\n            after.addClass('sel1');\n        \t\n            this.selected = {a:item,b:after};\n            return this.selected;\n        },\n        fromId : function(id) { \n            var e = $('#_item_' + id);\n            if(e.length != 0)\n                return this.fromElem(e);\n            return null;\n        },\n        fromElem : function(e) {\n            var r = {};\n            var c = e.children();\n            r.id = e.attr('id').substr(6);\n            r.n = $(c[0]).text();\n            r.d = $(c[1]).text();\n            r.dn = $(c[2]).text();\n            r.c = $(c[3]).text();\n            r.did = parseInt($(c[2]).attr('did'));\n            return r;\n        },\n        buildRow : function(item) {\n            var data = '<tr id=\"_item_' + item.id + '\" class=\"titem\" onclick=\"javascript:mCall(' + '\\'' + \n            this._module + '\\'' + ',\\'selItem\\',[\\'' + item.id + '\\']);\"><td>' + \n            item.n + '</td><td>' + item.d + '</td><td did=\"' + item.did + '\">' + item.dn + '</td><td>' + item.c + '</td></tr>';\n            return data;\n        },\n        renderRow : function(item, front) {\n            if(front)\n                $('#result').prepend(this.buildRow(item));\n            else\n                $('#result').append(this.buildRow(item));\n        },\n        replaceNode : function(item, elem) {\n            elem.replaceWith(this.buildRow(item));\n            this.selItem(item.id, item.n, true);\n        },\n        renderTableHdr : function() {\n            var i18n = this.i18n.info;\n            $('#thdr').html('<tr class=\"thdr\"><th>' + i18n.n +\n                            '</th><th>' +  i18n.dsc +\n                            '</th><th>' +  i18n.dn + \n                            '</th><th>' +  i18n.c + \n                            '</th></tr>');\n        },\n        doList : function(o, after, p) {\n            var i18n = this.i18n.info;\n            var _this = this;\n            var params = p || parseSearch();\n            this.renderTableHdr();\n            this.page = 1;\n            this.ipp = 10;\n            this.filter1 = undefined;\n            this.filter2 = undefined;\n            this.filter3 = undefined;\n            this.filter4 = undefined;\n            this.order = undefined;\n            this.selected = undefined;\n            var d = {cmd:19};\n            if(o)\n            {\n                if(o.i)  this.ipp = o.i;\n                if(o.p)  this.page = o.p + 1;\n                if(o.f1) this.filter1 = o.f1;\n                if(o.f2) this.filter2 = o.f2;\n                if(o.f3) this.filter3 = o.f3;\n                if(o.f4) this.filter4 = o.f4;\n                if(o.o)  this.order = o.o;\n                if(o.p)\n                    o.p = o.p * this.ipp;\n                d.data = JSON.stringify(o);\n            }\n            postCreds(userBase('/admin/'), {data:JSON.stringify(d)}, function(data) {\n                if(data.r == 0) {\n                    _this.max = typeof data.m === 'number' ? data.m : 0;\n                    _this.renderTable(data.d);\n                    if(params.s) {\n                        _this.selItem(params.s, false, true);\n                    }\n                } else {\n                    modalError(i18n.lfail);\n                }\n                \n                if(after)\n                    after();\n            });\n        },\n        doSave : function(item, elem) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            postCreds(userBase('/admin/'), {data:'{\"cmd\":22, \"data\":' + JSON.stringify('{\"id\":' + item.id + ',\"d\":\"' + item.d + '\"}') + '}'}, function(data) {\n                if(data.r == 0) {\n                    _this.replaceNode(item, elem);\n                    _this.selItem(item.id, true, true);\n                } else {\n                    modalError(i18n.sfail);\n                }\n            });\n            \n        },\n        doRemove : function(item) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            var id = item.id;\n            var did = item.did;\n            var dash = item.dn;\n            var name = item.n;\n            getNodeByDashID(did, function(node) {\n                /* cross remove from node with name */ \n                postCredsCross({id:node.id}, userBase('/server/', node.name), {data:'{\"cmd\":13,\"data\":' + JSON.stringify(JSON.stringify({an:dash,dn:name,n:1})) + '}'}, function(data) {\n                    if(data.r == 0 || data.r == 270532633) { /* ok or not exist */\n                        /* unregister with user dash */\n                        postCreds(userBase('/admin/'), {data:'{\"cmd\":21, \"data\":' + JSON.stringify(id) + '}'}, function(data) {\n                            if(data.r == 0) {\n                                _this.selItem(id, false, false);\n                                $('#_item_' + id).remove();\n                            } else {\n                                modalError(i18n.rfail);\n                            }\n                        });\n                    } else {\n                        modalError(i18n.rfail);\n                    }\n                });\n            });\n        },\n        doRemoveCert : function(item) {\n            var _this = this;\n            var i18n = this.i18n.info;\n            var id = item.id;\n            var did = item.did;\n            var dash = item.dn;\n            var name = item.n;\n            getNodeByDashID(did, function(node) {\n                /* cross remove from node with name */ \n                //postCredsCross({id:node.id}, userBase('/server/', node.name), {data:'{\"cmd\":13,\"data\":' + JSON.stringify(JSON.stringify({an:dash,dn:name,n:1})) + '}'}, function(data) {\n                //    if(data.r == 0 || data.r == 270532633) { /* ok or not exist */\n                        /* unregister with user dash */\n                        postCreds(userBase('/admin/'), {data:'{\"cmd\":35, \"data\":' + JSON.stringify(id) + '}'}, function(data) {\n                            if(data.r == 0) {\n                                item.c = '';\n                                _this.replaceNode(item, elem);\n                                _this.selItem(item.id, true, true);\n                            } else {\n                                modalError(i18n.dfail);\n                            }\n                        });\n                //    } else {\n                //        modalError(i18n.rfail);\n                //    }\n                //});\n            });\n        },\n        run : function() {\n            var _this = this;\n            var params = parseSearch();\n            \n              var o = {};\n            if(params.p)  o.p = parseInt(params.p) - 1;\n            if(params.i)  o.i = parseInt(params.i);\n            if(params.f1) o.f1 = params.f1;\n            if(params.f2) o.f2 = params.f2;\n            if(params.f3) o.f3 = params.f3;\n            if(params.f4) o.f4 = params.f4;\n            if(params.o)  o.o = parseInt(params.o);\n            \n            this.doList(o, function() {\n                if(params.n) {\n                    _this.showAdd(function() {\n                        $(\"#td\").val(params.did);\n                        $(\"#nn\").val(params.n);\n                    });\n                }\n                if(_this.filter1 || _this.filter2 || _this.filter3 || _this.filter4 || _this.order != undefined)\n                    _this.renderFilter();\n                else\n                    _this.renderMenu();\n            }, params);\n        }\n    }\n}();</script>","content":"<div class=\"linner\"><div id=\"add_form\"></div><form onsubmit=\"return false;\"><table class=\"tlist thead\" style=\"margin-top:20px;\"><thead class=\"full\"><tr><th><h1>{{info.head}}</h1></th><th></th><th></th><th></th></tr></thead><tbody id=\"tmenu\"></tbody></table></form><div class=\"pmenu\"></div><form onsubmit=\"return false;\"><table class=\"tlist\"><thead id=\"thdr\"></thead><tbody id=\"result\"></tbody></table></form><div class=\"pmenu\"></div><div style=\"clear:both;\"></div></div>"}}